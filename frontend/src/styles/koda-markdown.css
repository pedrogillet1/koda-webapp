/**
 * ============================================================================
 * KODA MARKDOWN CSS CONTRACT
 * ============================================================================
 *
 * This CSS file implements the frontend side of the Koda Markdown Contract.
 *
 * CORE PRINCIPLE:
 * - Frontend controls ALL visual spacing
 * - Backend only provides semantic structure
 *
 * RULES:
 * 1. Reset all default HTML margins
 * 2. Apply consistent bottom spacing to all blocks
 * 3. Make headings "chat-sized" (not huge)
 * 4. Tight lists with minimal spacing
 * 5. No extra margins from wrappers
 *
 * USAGE:
 * Wrap all markdown content in <div class="koda-markdown">
 *
 * ============================================================================
 */

/* ============================================================================
   1. RESET DEFAULT MARGINS
   ============================================================================ */

.koda-markdown h1,
.koda-markdown h2,
.koda-markdown h3,
.koda-markdown h4,
.koda-markdown h5,
.koda-markdown h6,
.koda-markdown p,
.koda-markdown ul,
.koda-markdown ol,
.koda-markdown blockquote,
.koda-markdown pre {
  margin-top: 0;
}

/* ============================================================================
   2. CONSISTENT BOTTOM SPACING
   ============================================================================ */

/* All block elements get balanced bottom spacing */
.koda-markdown p,
.koda-markdown ul,
.koda-markdown ol,
.koda-markdown h2,
.koda-markdown h3,
.koda-markdown h4,
.koda-markdown blockquote {
  margin-bottom: 0.375rem !important; /* 6px - balanced spacing */
}

/* Paragraph followed by list - MORE SPACING */
.koda-markdown p + ol,
.koda-markdown p + ul {
  margin-top: 1rem !important; /* 16px */
}

/* Code blocks get slightly more spacing */
.koda-markdown pre {
  margin-bottom: 1rem; /* 16px */
}

/* Last element in container has no bottom margin */
.koda-markdown > *:last-child {
  margin-bottom: 0;
}

/* ============================================================================
   3. CHAT-SIZED HEADINGS
   ============================================================================ */

/* H2 = Main title (backend sends ## for titles) */
.koda-markdown h2 {
  font-size: 1rem; /* 16px - same as body text */
  font-weight: 600; /* Semi-bold */
  line-height: 1.5;
  color: inherit;
  margin-bottom: 0.5rem; /* 8px */
}

/* H3 = Section heading */
.koda-markdown h3 {
  font-size: 0.9375rem; /* 15px - slightly smaller */
  font-weight: 600; /* Semi-bold */
  line-height: 1.5;
  color: inherit;
  margin-bottom: 0.5rem; /* 8px */
}

/* H4 = Sub-section */
.koda-markdown h4 {
  font-size: 0.875rem; /* 14px */
  font-weight: 600; /* Semi-bold */
  line-height: 1.5;
  color: inherit;
  margin-bottom: 0.375rem; /* 6px */
}

/* H1, H5, H6 should not be used, but style them just in case */
.koda-markdown h1 {
  font-size: 1.125rem; /* 18px */
  font-weight: 600;
  line-height: 1.5;
  margin-bottom: 0.75rem;
}

.koda-markdown h5,
.koda-markdown h6 {
  font-size: 0.875rem; /* 14px */
  font-weight: 600;
  line-height: 1.5;
  margin-bottom: 0.375rem;
}

/* ============================================================================
   4. TIGHT LISTS
   ============================================================================ */

/* List containers */
.koda-markdown ul,
.koda-markdown ol {
  padding-left: 1.25rem; /* 20px - indentation */
  margin-bottom: 0.375rem !important; /* 6px */
  margin-top: 0.375rem !important;
}

/* Top-level numbered list - section spacing */
.koda-markdown > ol > li + li {
  margin-top: 1.5rem !important; /* 24px between sections */
}

/* Bullet points inside sections */
.koda-markdown li > ul > li + li,
.koda-markdown li > ol > li + li {
  margin-top: 0.375rem !important; /* 6px normal spacing */
}

/* List items */
.koda-markdown li {
  margin-top: 0.125rem; /* 2px */
  margin-bottom: 0.125rem; /* 2px */
  line-height: 1.6;
}

/* Bold numbers for ordered lists */
.koda-markdown ol {
  list-style: none;
  counter-reset: item;
  padding-left: 1.5rem !important;
}

.koda-markdown ol > li {
  counter-increment: item;
  position: relative;
}

.koda-markdown ol > li::before {
  content: counter(item) ".";
  font-weight: 700;
  position: absolute;
  left: -1.5rem;
}

/* Nested lists */
.koda-markdown li > ul,
.koda-markdown li > ol {
  margin-top: 0.25rem; /* 4px */
  margin-bottom: 0.25rem; /* 4px */
}

/* No extra spacing for first/last items */
.koda-markdown ul > li:first-child,
.koda-markdown ol > li:first-child {
  margin-top: 0;
}

.koda-markdown ul > li:last-child,
.koda-markdown ol > li:last-child {
  margin-bottom: 0;
}

/* ============================================================================
   5. PARAGRAPHS & TEXT
   ============================================================================ */

.koda-markdown p {
  font-size: 0.875rem; /* 14px */
  line-height: 1.6;
  color: inherit;
  margin-bottom: 0.375rem !important; /* 6px */
}

/* Strong (bold) text */
.koda-markdown strong {
  font-weight: 600;
  color: inherit;
}

/* Emphasis (italic) text */
.koda-markdown em {
  font-style: italic;
  color: inherit;
}

/* ============================================================================
   6. CODE BLOCKS & INLINE CODE
   ============================================================================ */

/* Inline code */
.koda-markdown code {
  font-family: 'Courier New', Courier, monospace;
  font-size: 0.8125rem; /* 13px */
  background-color: rgba(0, 0, 0, 0.05);
  padding: 0.125rem 0.25rem;
  border-radius: 0.25rem;
}

/* Code blocks */
.koda-markdown pre {
  font-family: 'Courier New', Courier, monospace;
  font-size: 0.8125rem; /* 13px */
  background-color: rgba(0, 0, 0, 0.05);
  padding: 0.75rem;
  border-radius: 0.375rem;
  overflow-x: auto;
  line-height: 1.5;
}

.koda-markdown pre code {
  background-color: transparent;
  padding: 0;
  border-radius: 0;
}

/* ============================================================================
   7. BLOCKQUOTES
   ============================================================================ */

.koda-markdown blockquote {
  border-left: 0.25rem solid rgba(0, 0, 0, 0.1);
  padding-left: 1rem;
  margin-left: 0;
  margin-right: 0;
  margin-bottom: 0.5rem; /* 8px - REDUCED FROM 12px */
  font-style: italic;
  color: rgba(0, 0, 0, 0.7);
}

/* ============================================================================
   8. LINKS
   ============================================================================ */

.koda-markdown a {
  color: #1a1a1a !important;
  text-decoration: underline !important;
  font-weight: 600 !important;
}

.koda-markdown a:hover {
  color: #000000 !important;
  text-decoration: underline !important;
}

/* ============================================================================
   9. TABLES
   ============================================================================ */

.koda-markdown table {
  width: 100%;
  border-collapse: collapse;
  margin-bottom: 1rem;
  font-size: 0.875rem;
}

.koda-markdown th,
.koda-markdown td {
  border: 1px solid rgba(0, 0, 0, 0.1);
  padding: 0.5rem;
  text-align: left;
}

.koda-markdown th {
  background-color: rgba(0, 0, 0, 0.05);
  font-weight: 600;
}

/* ============================================================================
   10. HORIZONTAL RULES
   ============================================================================ */

.koda-markdown hr {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  margin: 1rem 0;
}

/* ============================================================================
   11. DOCUMENT NAMES (CLICKABLE)
   ============================================================================ */

/* Document names should be inline, no extra spacing */
.koda-markdown .document-name {
  display: inline;
  font-weight: 600;
  color: #1a1a1a !important; /* ✅ BLACK - no blue */
  cursor: pointer;
  text-decoration: none !important;
}

.koda-markdown .document-name:hover {
  color: #000000 !important; /* ✅ BLACK on hover */
  text-decoration: none !important; /* ✅ NO underline */
}

/* ============================================================================
   12. SOURCES SECTION
   ============================================================================ */

/* Sources section should be visually separated but not huge */
.koda-markdown .sources-section {
  margin-top: 1.5rem;
  padding-top: 1rem;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.koda-markdown .sources-section h2 {
  font-size: 0.875rem; /* 14px - smaller than main title */
  font-weight: 600;
  color: rgba(0, 0, 0, 0.6);
  margin-bottom: 0.5rem;
}

.koda-markdown .sources-section ul {
  margin-bottom: 0;
}

.koda-markdown .sources-section li {
  font-size: 0.8125rem; /* 13px - even smaller */
  color: rgba(0, 0, 0, 0.7);
}

/* ============================================================================
   13. DARK MODE SUPPORT
   ============================================================================ */

@media (prefers-color-scheme: dark) {
  .koda-markdown code {
    background-color: rgba(255, 255, 255, 0.1);
  }

  .koda-markdown pre {
    background-color: rgba(255, 255, 255, 0.05);
  }

  .koda-markdown blockquote {
    border-left-color: rgba(255, 255, 255, 0.2);
    color: rgba(255, 255, 255, 0.7);
  }

  .koda-markdown th {
    background-color: rgba(255, 255, 255, 0.05);
  }

  .koda-markdown th,
  .koda-markdown td {
    border-color: rgba(255, 255, 255, 0.1);
  }

  .koda-markdown hr {
    border-top-color: rgba(255, 255, 255, 0.1);
  }

  .koda-markdown .sources-section {
    border-top-color: rgba(255, 255, 255, 0.1);
  }

  .koda-markdown .sources-section h2 {
    color: rgba(255, 255, 255, 0.6);
  }

  .koda-markdown .sources-section li {
    color: rgba(255, 255, 255, 0.7);
  }
}

/* ============================================================================
   14. RESPONSIVE ADJUSTMENTS
   ============================================================================ */

@media (max-width: 640px) {
  /* Slightly smaller text on mobile */
  .koda-markdown p {
    font-size: 0.8125rem; /* 13px */
  }

  .koda-markdown h2 {
    font-size: 0.9375rem; /* 15px */
  }

  .koda-markdown h3 {
    font-size: 0.875rem; /* 14px */
  }

  /* Tighter spacing on mobile */
  .koda-markdown p,
  .koda-markdown ul,
  .koda-markdown ol,
  .koda-markdown h2,
  .koda-markdown h3 {
    margin-bottom: 0.5rem; /* 8px */
  }
}

/* ============================================================================
   15. UTILITY CLASSES
   ============================================================================ */

/* Force tight spacing (for special cases) */
.koda-markdown.tight p,
.koda-markdown.tight ul,
.koda-markdown.tight ol {
  margin-bottom: 0.5rem;
}

.koda-markdown.tight li {
  margin-top: 0;
  margin-bottom: 0;
}

/* Force loose spacing (for special cases) */
.koda-markdown.loose p,
.koda-markdown.loose ul,
.koda-markdown.loose ol {
  margin-bottom: 1.25rem;
}
